{
  "NDM_metadata": {
    "authority": "Broadcom Corporation",
    "OF_protocol_version": "1.3.4",
    "type": "TTPv1",
    "name": "OF-DPA 2.0",
    "version": 1,
    "doc": [
      "OF-DPA 2.0 specification: OFDPA_ASSV-ETP200-R.pdf"
    ]
  },
  "features": [
    {
      "feature": "ALLOW_IN_PORT",
      "doc": ["Used in group entries to override default OpenFlow forwarding behavior"]
    },
    {
      "feature": "MTU_CHECK"
    }
  ],
  "table_map": [
    {"name": "Ingress Port", "number": 0},
    {"name": "Port DSCP Trust", "number": 5},
    {"name": "Port PCP Trust", "number": 6},
    {"name": "Tunnel DSCP Trust", "number": 7},
    {"name": "Tunnel PCP Trust", "number": 8},
    {"name": "VLAN", "number": 10},
    {"name": "VLAN 1", "number": 11},
    {"name": "Ingress Maintenance Point", "number": 12},
    {"name": "MPLS L2 Port", "number": 13},
    {"name": "MPLS L2 Port DSCP Trust", "number": 15},
    {"name": "MPLS L2 Port PCP Trust", "number": 16},
    {"name": "Termination MAC", "number": 20},
    {"name": "MPLS 0", "number": 23},
    {"name": "MPLS 1", "number": 24},
    {"name": "MPLS 2", "number": 25},
    {"name": "MPLS-TP Maintenance Point", "number": 26},
    {"name": "Unicast Routing", "number": 30},
    {"name": "Multicast Routing", "number": 40},
    {"name": "Bridging", "number": 50},
    {"name": "L2 Policer", "number": 55},
    {"name": "L2 Policer Actions", "number": 56},
    {"name": "Policy ACL", "number": 60},
    {"name": "Color Based Actions", "number": 65},
    {"name": "Egress VLAN", "number": 210},
    {"name": "Egress VLAN 1", "number": 211},
    {"name": "Egress Maintenance Point", "number": 226}
  ],
  "identifiers": [
    {
      "var": "<pport_no>",
      "doc": [
        "ifNum, 32-bit value. Physical ports in range 1..65535 (0x0000nnnn)."
      ]
    },
    {
      "var": "<lport_no>",
      "doc": ["ifNum, 32-bit value. Logical ports > 65536"]
    },
    {
      "var": "<port_no>",
      "doc": ["ifNum, any port"]
    },
    {
      "var": "<vid>",
      "range": "1..4095",
      "doc": [
        "12-bit VLAN id value from header field.",
        "OpenFlow sets bit 12 to indicate presence of the field."
      ]
    },
    {
      "var": "<tunnel_id>",
      "doc": [
        "Different ranges for different tunnel types.",
        "For overlay VxLAN tunnels, value: 1..65535 (0x0000nnnn).",
        "For MPLS, value: 65536..131072 (0x0001nnnn).",
        "Non-tunnel packets from physical ports always have tunnel_id zero,",
        "all others must be non-zero."
      ]
    },
    {
      "var": "<eth_type>",
      "doc": [
        "Any valid ethertype, which will be  >1536 (0x0600),",
        "except for 0x8870 (jumbo frame)"
      ]
    },
    {
      "var": "<pcp>",
      "range": "0..7",
      "doc": ["VLAN header PCP field"]
    },
    {
      "var": "<dei>",
      "range": "0..1",
      "doc": ["VLAN header DEI field"]
    },
    {
      "var": "<ip_dscp>",
      "range": "0..255",
      "doc": ["IP Header DSCP field."]
    },
    {
      "var": "<qos_index>",
      "doc": ["index into a QoS table"]
    },
    {
      "var": "<lmep_id>",
      "doc": ["32-bit value"]
    },
    {
      "var": "<mdl>",
      "range": "0..7",
      "doc": ["Y.1731 OAM frame maintenance level."]
    },
    {
      "var": "<mpls_l2_port>",
      "doc": [
        "Virtual ingress port for MPLS packets.",
        "Distinguishes VPWS from VPLS, and local ports from network ports.",
        "For VPWS, local port value: 0..65535 (0x0000nnnn), network port value 131072-262143 (0x0002nnnn).",
        "For VPLS, local port value: 16536..31072 (0x0001nnnn), network port value:  262144..524288 (0x0003nnnn)."
      ]
    },
    {
      "var": "<local_mac>",
      "doc": ["Unicast MAC address of router."]
    },
    {
      "var": "<l2_meter_index>",
      "range": ">65537",
      "doc": [
        "Index into meter table for an L2 service meter.",
        "Pipeline metadata"
      ]
    },
    {
      "var": "<meter_index>",
      "range": "1..65535 (0x0000nnnn)",
      "doc": ["Index into meter table for a Policy ACL meter."]
    },
    {
      "var": "<color_actions_index>",
      "doc": [
        "Index into a color actions table.",
        "Pipeline metadata."
      ]
    },
    {
      "var": "<mac>",
      "doc": ["A MAC address"]
    },
    {
      "var": "<vrf>",
      "doc": ["VRF pipeline metadata."]
    },
    {
      "var": "<ipv4_addr>",
      "doc": ["IPv4 Address - 32 bits represented as 4 decimal values - nnn.nnn.nnn.nnn"]
    },
    {
      "var": "<ipv6_addr>",
      "doc": ["IPv6 Address - 128 bits represented as 8 groups of hex quartets - nnnn:nnnn:nnnn:nnnn:nnnn:nnnn:nnnn:nnnn"]
    },
    {
      "var": "<l3_in_port>",
      "doc": [
        " L3 Virtual Ingress Port, used for multicast forwarding.",
        "Pipeline metadata"
      ]
    },
    {
      "var": "<udp_src>",
      "range": "1..65535",
      "doc": ["16-bit UDP source port"]
    },
    {
      "var": "<mpls_label>",
      "range": "1..1048575",
      "doc": ["20-bit label - reserved values should be excluded"]
    },
    {
      "var": "<mpls_tc>",
      "range": "0..7",
      "doc": ["3-bit MPLS header TC field."]
    },
    {
      "var": "<opcode>",
      "range": "0..255",
      "doc": ["Y.1731 header opcode field."]
    },
    {
      "var": "<<group_entry_types:name>>",
      "doc": ["OF-DPA Group Entry Identifier (see Name Format in Group Entry Types)"]
    },
    {
      "id": "PUSH_L2_HEADER",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 1,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "POP_L2_HEADER",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 2,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "PUSH_CW",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 3,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "POP_CW_OR_ACH",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 4,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "COPY_MPLS_TC_IN",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 5,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "COPY_MPLS_TC_OUT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 6,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "SET_MPLS_TC_FROM_VPN_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 7,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "SET_DSCP_FROM_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 8,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "SET_PCPDEI_FROM_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 9,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "OAM_LM_TX_COUNT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 10,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "OAM_LM_RX_COUNT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 11,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "OAM_SET_COUNTER_FIELDS",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 12,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "CHECK_DROP_STATUS",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 14,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "MPLS_SET_QOS_FROM_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 15,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "SET_MPLS_PCPDEI_FROM_VPN_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 16,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "SET_MPLS_TC_FROM_TUNNEL_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 17,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "SET_MPLS_PCPDEI_FROM_TUNNEL_TABLE",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 18,
      "doc": ["OF-DPA Action Identifier defined in OF-DPA 2.0."]
    },
    {
      "id": "CLASS_BASED_TX_COUNT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 19,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "CLASS_BASED_RX_COUNT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 20,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "COLOR_BASED_TX_COUNT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 21,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "COLOR_BASED_RX_COUNT",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 22,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "DEC_TTL_MTU",
      "type": "action",
      "exp_id": "0x1018",
      "exp_code": 13,
      "doc": [
        "OF-DPA Match Field Identifier defined in OF-DPA 2.0",
        "Not used."
      ]
    },
    {
      "id": "VRF",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 1,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "TRAFFIC_CLASS",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 2,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "COLOR",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 3,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "VLAN_DEI",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 4,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "QOS_INDEX",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 5,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "LMEP_ID",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 6,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "MPLS_TTL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 7,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "MPLS_L2_PORT",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 8,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "L3_IN_PORT",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 9,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "OVID",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 10,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "MPLS_DATA_FIRST_NIBBLE",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 11,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "MPLS_ACH_CHANNEL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 12,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "NEXT_LABEL_IS_GAL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 13,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "OAM_Y1731_MDL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 14,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "OAM_Y1731_OPCODE",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 15,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "COLOR_ACTIONS_INDEX",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 16,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "TXFCL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 17,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "RXFCL",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 18,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "RX_TIMESTAMP",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 19,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "PROTECTION_INDEX",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 21,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "ETH_SUB_TYPE",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 22,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    },
    {
      "id": "ACTSET_OUTPUT",
      "type": "field",
      "exp_id": "0x1018",
      "exp_code": 42,
      "doc": ["OF-DPA Match Field Identifier defined in OF-DPA 2.0"]
    }
  ],
  "flow_tables": [
    {
      "name": "Ingress Port",
      "doc": [
        "First table in pipeline.",
        "Decapsulated overlay packets processed by Bridging table.",
        "Normal Ethernet packets processed by VLAN table.",
        "Injected OAM frames processed by Injected OAM table."
      ],
      "flow_mod_types": [
        {
          "name": "Normal Ethernet IPv4 DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the same",
            "QoS index values must be specified.",
            "<port> must be a physical port",
            "<tunnel_id> must be zero"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Normal Ethernet IPv6 DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the same",
            "QoS index values must be specified.",
            "<port> must be a physical port",
            "<tunnel_id> must be zero"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Normal Ethernet PCP",
          "priority": "4",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "<port> must be a physical port",
            "<tunnel_id> must be zero"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Port PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Normal Ethernet",
          "priority": "3",
          "doc": [
            "Matches all physical ports. Default on miss.",
            "Lowest priority",
            "<pport_no>  must be a physical port",
            "<tunnel_id> must be zero"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel IPV4  DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the",
            "same QoS index values must be sepcified.",
            "<pport_no> must be a tunnel logical port",
            "<tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<lport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00000000"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Tunnel DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel IPv6 DSCP",
          "priority": "5",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "If both v4 and v6 are specified on the same port then the same.",
            "QoS index values must be sepcified.",
            "<pport_no> must be a tunnel logical port",
            "<tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<lport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00000000"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Tunnel DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel PCP",
          "priority": "4",
          "doc": [
            "Must be higher priority if overlapping with non-QoS rule.",
            "<pport_no> must be a tunnel logical port",
            "<tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<lport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00000000"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Tunnel PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                }
              ]
            }
          ]
        },
        {
          "name": "Overlay Tunnel",
          "priority": "3",
          "doc": [
            "Matches unclassified tunnel overlaid packets.",
            "Must be lower priority than overlapping rules .",
            "<tunnel_id> must be in the overlay range and non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<lport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<eth_type>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00000000"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        },
        {
          "name": "OAM PDU Injection",
          "priority": "2",
          "doc": [
            "Intended to match injected CFM/Y.1732 frames.on a port.",
            "<lmep_id> must be non-zero."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "<lmep_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Injected OAM"
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Normal Ethernet VLAN",
          "priority": "0",
          "doc": [
            "Built-in default rule for packets that are not tunnel packets.",
            "Matches any frame with zero <tunnel_id>."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "0",
              "match_type": "all_or_exact"
            },
            {
              "field": "$LMEP_ID",
              "value": "0",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        }
      ]
    },
    {
      "name": "Port DSCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification IPv4",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        },
        {
          "name": "Trust Classification IPv6",
          "priority": "1",
          "doc": [
            "Classify ingress IP packet by DSCP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Passthrough",
          "priority": "0",
          "doc": [
            "Built-in default, go to VLAN Table"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        }
      ]
    },
    {
      "name": "Port PCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Passthrough",
          "priority": "0",
          "doc": [
            "Built-in default, go to VLAN Table"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN"
            }
          ]
        }
      ]
    },
    {
      "name": "Tunnel DSCP Trust",
      "doc": [
        "Classify traffic class and color based on VLAN PCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Passthrough",
          "priority": "0",
          "doc": [
            "Builtin default, go to Bridging Table"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "Tunnel PCP Trust",
      "doc": [
        "Classify traffic class and color based on VLAN PCP field."
      ],
      "flow_mod_types": [
        {
          "name": "Trust Classification",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Passthrough",
          "priority": "0",
          "doc": [
            "Builtin default, go to Bridging Table"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "VLAN",
      "doc": [
        "Ingress VLAN Assignment and Translation.",
        "If Ethernet Service MIP configured send frame to Ingress Maintenance Point.",
        "Process two tags by assigning metadata, pop, go to VLAN 1 to process inner tag."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Filtering",
          "priority": "3",
          "doc": [
            "Matches outer VLAN ID."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Assignment - Untagged or Priority Tagged (Port VLAN Assignment)",
          "priority": "3",
          "doc": [
            "Port VLAN for untagged or priority tagged (VID=0). Sets outer VLAN.",
            "Switch behavior follows OpenFlow 1.0 model: If priority tagged sets VLAN Id.",
            "If packet is untagged switch pushes an outer tag with TPID 0x8100."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "0",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x0000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Allow All",
          "priority": "7",
          "doc": [
            "Turn off VLAN filtering. Does not assign VRF. Untagged packets have illegal VLAN"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            }
          ]
        },
        {
          "name": "VLAN Translate Single Tag or Single Tag to Double Tag",
          "priority": "2",
          "doc": [
            "New assigned outermost VLAN_VID becomes learning and forwarding VLAN",
            "TPID must be either 0x8100 or 0x88a8 from OpenFlow spec."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "PUSH_VLAN",
                      "value": "<tpid>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$VRF",
                      "value": "<vrf>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Translate Double Tag to Single Tag",
          "priority": "2",
          "doc": [
            "OVID is new pipeline metadata. Required for double tag match."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>"
                },
                {
                  "action": "POP_VLAN"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Single Tag",
          "priority": "6",
          "doc": [
            "MPLS match criteria - single tagged VLAN. Next table depends on whether MIP is enabled",
            "A port cannot have conflicting VLAN match and all traffic rules",
            "Next table is Ingress Maintenance Point if MIP configured. "
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Ingress Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_TX_COUNT"
                      //"index": "<tunnel_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Double Tag",
          "priority": "5",
          "doc": [
            "MPLS match criteria - double tagged VLAN."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "VLAN 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>"
                },
                {
                  "action": "POP_VLAN"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 All Traffic on Port",
          "priority": "6",
          "doc": [
            "MPLS - all traffic on port (VLAN omitted, highest priority). Next table depends on whether",
            "MIP is enabled. A port cannot have conflicting VLAN match and  all traffic rules.",
            "Next table is Ingress Maintenance Point if MIP configured."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Ingress Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_TX_COUNT"
                      //"index": "<tunnel_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Ethernet  Link OAM",
          "priority": "11",
          "doc": [
            "802.3ah Link OAM (Slow Protocol)"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8809",
              "match_type": "exact"
            },
            {
              "field": "MAC_DST",
              "value": "01-80-C2-00-00-02",
              "match_type": "exact"
            },
            {
              "field": "$ETH_SUB_TYPE",
              "value": "3",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Ethernet  Link OAM Loopback",
          "priority": "10",
          "doc": [
            "802.3ah Link OAM (Slow Protocol)"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<pport_no>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Loopback>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Drop",
          "priority": "0",
          "doc": [
            "Default drop rule, no VLAN for frame."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "VLAN 1",
      "doc": [
        "Used to process inner tag.",
        "Final packet can be untagged, single tagged, or double tagged."
      ],
      "flow_mod_types": [
        {
          "name": "Stacked VLAN Assignment",
          "priority": "2",
          "doc": [
            "Pop-then-PUSH_VLAN tag allows setting the TPID",
            "TPID must be either 0x8100 or 0x88a8 from OpenFlow spec."
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<port>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            },
            {
              "field": "$OVID",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Termination MAC"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "POP_VLAN"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    },
                    {
                      "all": [
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        },
                        {
                          "action": "PUSH_VLAN"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS L2 Stacked VLAN",
          "priority": "2",
          "doc": [
            "Pop-then-PUSH_VLAN tag allows setting the TPID",
            "Can restore VLAN stack by pushing the OVID that was matched on ",
            "Next table is Ingress Maintenance Point if MIP configured. "
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<port>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            },
            {
              "field": "$OVID",
              "value": "<vid>",
              "match_type": "mask",
              "mask": "0x0fff",
              "const_value": "0x1000",
              "const_mask": "0x1000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Ingress Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "POP_VLAN"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    },
                    {
                      "all": [
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        },
                        {
                          "action": "PUSH_VLAN"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_TX_COUNT"
                      //"index": "<tunnel_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Drop",
          "priority": "0",
          "doc": [
            "Default drop rule, unable to process stacked VLAN tags"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "Ingress Maintenance Point",
      "doc": [
        "Process packets for Ethernet Service OAM MIP or MEP from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MIP LBM Process (Client MDL)",
          "priority": "5",
          "doc": [
            "Configure MIP (LTM to local MAC)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "3",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_DST",
              "value": "<local_mac>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MIP LTM Process (Client MDL)",
          "priority": "4",
          "doc": [
            "Configure MIP (LTR, destination MAC is Class 2 Multicast)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "5",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Down MEP PDU",
          "priority": "5",
          "doc": [
            "CE-PE or PE-PE Down MEP.",
            "Process all PDUs at specified MDL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Passthru (higher MDL)",
          "priority": "3",
          "doc": [
            "Must be programmed to pass higher MDL PDUs for this user and treat as data.",
            "Otherwise these PDUs may be dropped.",
            "Provider Up MEP LMEP_Id LM count in Action Set (count after conditioning).",
            "Interface Down MEP LMEP_Id count in Action List (count on receipt)."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Drop (lower MDL)",
          "priority": "2",
          "doc": [
            "Must be programmed to enable active filtering of lower MDL for this user.",
            "The optional output is so OAM engine can generate drop notification."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MEP Data",
          "priority": "1",
          "doc": [
            "Provider Up MEP LMEP_Id LM count in Action Set (count after conditioning).",
            "Interface Down MEP LMEP_Id count in Action List (count on receipt)."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id>"
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_TX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Passthru",
          "priority": "0",
          "doc": [
            "Default rule, built in. Intended to pass OAM data frames."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port",
      "doc": [
        "Represents ingress port for MPLS service flow from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS v4 DSCP VPWS",
          "priority": "4",
          "doc": [
            "Fowarding decision for E-LINE flows classified by IPv4 DSCP."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xfffd0000",
              "const_value": " 0x00000000"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xffff0000",
              "const_value": " 0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS 1+1 Head End Protection>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS v6 DSCP VPWS",
          "priority": "4",
          "doc": [
            "Fowarding decision for  E-LINE flows classified by IPv6 DSCP."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xfffd0000",
              "const_value": " 0x00000000"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xffff0000",
              "const_value": " 0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port DSCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS 1+1 Head End Protection>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS PCP VPWS",
          "priority": "3",
          "doc": [
            "Fowarding decision for  E-LINE flows classified by VLAN PCP"
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xfffd0000",
              "const_value": " 0x00000000"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xffff0000",
              "const_value": " 0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS L2 Port PCP Trust"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$QOS_INDEX",
                  "value": "<qos_index>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS 1+1 Head End Protection>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VPWS Forward",
          "priority": "1",
          "doc": [
            "Forwarding decision for unclassified  E-LINE flows.",
            "Terminates pipeline if no next table specified."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "mask",
              "mask": "0x0000ffff",
              "const_mask": " 0xffff0000",
              "const_value": " 0x00010000"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "L2 Policer"
                },
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS 1+1 Head End Protection>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Default Drop",
          "priority": "0",
          "doc": [
            "Default drop rule, unable to forward packet."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port DSCP Trust",
      "doc": [
        "Classify traffic class and color based on IP DSCP field."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Trust Classification VPWS",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "0x00000000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Trust Classification VPWS",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "0x00000000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Trust Classification VPLS",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Trust Classification VPLS",
          "priority": "1",
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<ip_dscp>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default VPWS Passthru",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to L2 Policer Table."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "0x00000000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            }
          ]
        },
        {
          "name": "Default VPLS Passthru",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to Bridging Table."
          ],
          "match_set": [
            {
              "field": "MPLS_L2_PORT",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Port PCP Trust",
      "doc": [
        "Classify traffic class and color based on VLAN PCP field."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS-TP Trust Classification VPWS",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN _PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "0x00000000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS-TP Trust Classification VPLS",
          "priority": "1",
          "match_set": [
            {
              "field": "$QOS_INDEX",
              "value": "<qos_index>",
              "match_type": "exact"
            },
            {
              "field": "VLAN _PCP",
              "value": "<pcp>",
              "match_type": "exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<dei>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$TRAFFIC_CLASS",
                  "value": "<traffic_class>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR",
                  "value": "<color>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default VPWS Passthru",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to L2 Policer Table."
          ],
          "match_set": [
            {
              "field": "$MPLS_L2_PORT",
              "value": "0x00000000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            }
          ]
        },
        {
          "name": "Default VPLS Passthru",
          "priority": "0",
          "doc": [
            "Default on miss, pass through to Bridging Table."
          ],
          "match_set": [
            {
              "field": "$MPLS_L2_PORT",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "Termination MAC",
      "doc": [
        "Determine whether to bridge, route, or MPLS process a packet.",
        "Bridge packet if MAC destination is other than local.",
        "If local MAC then use ETH-TYPE to decide how to process."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Unicast MAC",
          "priority_rank": 2,
          "doc": [
            "IPv4 unicast routing."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Unicast MAC",
          "priority_rank": 2,
          "doc": [
            "IPv6 unicast routing."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Multicast MAC",
          "priority_rank": 2,
          "doc": [
            "Enables IPv4 multicast routing."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "01-00-5e-00-00-00",
              "match_type": "mask",
              "mask": " ff-ff-ff-80-00-00"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast MAC",
          "priority_rank": 2,
          "doc": [
            "Enables IPv6 multicast routing."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "33-33-00-00-00-00",
              "match_type": "mask",
              "mask": "ff-ff-00-00-00-00"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS",
          "priority_rank": 2,
          "doc": [
            "MPLS termination."
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 0"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Multicast IP",
          "priority_rank": 3,
          "doc": [
            "Unicast MAC with Multicast IPv4 DIP"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "224.0.0.0",
              "match_type": "mask",
              "mask": "224.0.0.0"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast IP",
          "priority_rank": 3,
          "doc": [
            "Unicast MAC with Multicast IPv6 DIP"
          ],
          "match_set": [
            {
              "field": "IN_PORT ",
              "value": "<port>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST ",
              "value": "<local_mac>",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "ff00:0:0:0:0:0:0:0",
              "match_type": "mask",
              "mask": "ff00:0:0:0:0:0:0:0"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority_rank": 0,
          "doc": [
            "Default on miss is to switch packet."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Bridging"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 0",
      "doc": [
        "Match outermost MPLS label.",
        "Used for three label processing scenarios.",
        "Miss continues to MPLS 1."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label",
          "priority": "1",
          "doc": [
            "LSP Pop. Not OAM enabled.",
            "MPLS_TC argument supplied from packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label BHH and forward based on next label (LSP OAM  MEP Data)",
          "priority": "1",
          "doc": [
            "LSP Pop OAM (Data)",
            "Indicates BHH enabled MEP, but a data frame - do OAM actions",
            "Conflicts with non-OAM rule, only one or the other can be installed.",
            "Must be installed with and before adding control PDU rule for this MEP.",
            "Does not take effect until control PDU rule installed.",
            "Label,[port] key to MP_GROUP, enable counters",
            "Check OAM Lock Status for LMEP_Id",
            "Count if LM if enabled for  LMEP_Id",
            "MPLS_TC argument supplied from packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<drop_status_id>",
                  //"type": 1
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<lmep_id>",
                  //"type": 0
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label BHH and forward based on next label (LSP OAM MEP Control)",
          "priority": "2",
          "doc": [
            "LSP Pop OAM (Control)",
            "Indicates BHH enabled MEP, OUTPUT OAM control frame.",
            "Pop GAL label and make packet look like an Ethernet OAM frame",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Must be installed with and after data rule (must be in pairs)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Pass through default",
          "priority": "1",
          "doc": [
            "Built-in default on miss - cannot be removed or modified."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS  1"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 1",
      "doc": [
        "First MPLS match table. Matches outermost MPLS shim header.",
        "Contains same flow entries as MPLS 2",
        "Updating MPLS 1 updates MPLS 2."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label",
          "priority": "1",
          "doc": [
            "LSP Pop. This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on this label (PHP)",
          "priority": "1",
          "doc": [
            "PHP Pop. PHP Actions are not OAM enabled.",
            "MPLS_TC argument supplied from packet for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label and forward based on this label",
          "priority": "1",
          "doc": [
            "LSP Swap. This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label and forward based on this label",
          "priority": "1",
          "doc": [
            "PW Swap, like LSP swap but BOS. Used for MS-PW.",
            "This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label BHH and forward based on next label LSP OAM (MEP Data)",
          "priority": "1",
          "doc": [
            "LSP Pop - OAM (Data) - MEP, but a data frame - do OAM actions.",
            "Conflicts with non-OAM rule, only one or the other can be installed.",
            "Must be installed before control PDU rule.",
            "Check OAM Lock Status for LMEP_Id",
            "Count if LM if enabled for  LMEP_Id",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 2"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<drop_status_id>",
                  //"type": 1
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<lmep_id>",
                  //"type": 0
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP OAM MEP Control)",
          "priority": "2",
          "doc": [
            "LSP Pop OAM (Control) - MEP OAM PDU.",
            "Pop GAL and make packet look like an Ethernet OAM frame.",
            "Higher priority than non-OAM rule for this label, which must be installed first."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label BHH LSP OAM (MIP Control)",
          "priority": "2",
          "doc": [
            "LSP MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop GAL and make packet look like an Ethernet OAM frame"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label BHH MS-PW OAM (MIP Control)",
          "priority": "2",
          "doc": [
            "PW MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Can only have a MIP on a swap action."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch VPWS (PW Terminate)",
          "priority": "1",
          "doc": [
            "VPWS PW Terminate.",
            "This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch VPWS (PW Terminate) (MEP Data)",
          "priority": "1",
          "doc": [
            "VPLS PW Terminate - MEP Data.",
            "Conflicts with non-OAM enabled rule, only one or the other can be installed.",
            "Must be installed before adding control PDU rule for this MEP.",
            "Does not take effect until control PDU rule installed.",
            "Check OAM Lock Status for LMEP_Id.",
            "Count if LM if enabled for  LMEP_Id.",
            "MPLS_TC argument supplied from packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<drop_status_id>",
                  //"type": 1
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<lmep_id>",
                  //"type": 0
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "$COLOR_BASED_RX_COUNT"
                  //"index": "<mpls_label>"
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW BHH VCCV 4 (PW Terminate) (MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP control packet.",
            "BHH enabled, next label is GAL.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first, otherwise error.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW BHH VCCV 1 (PW Terminate) (MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP control packet.",
            "BHH enabled, next label is GAL.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first, otherwise error.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW BHH VCCV 3 (MIP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MIP control packet.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Higher priority than non-OAM label rule, which must be installed first.",
            "Only one  VCCV control rule per label.",
            "This type of control is only for a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv4 Unicast)",
          "priority": "1",
          "doc": [
            "L3 Route. Not OAM enabled.",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv4 Multicast)",
          "priority": "2",
          "doc": [
            "L3 Route.",
            "Automatic rule, added when L3 Route added. Deleted when L3 Route deleted.",
            "Read only to CONTROLLER.",
            "MPLS_TC argument supplied from packet  for QoS table lookup.",
            "L3_IN_PORT used for multicast L3 source removal."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "224.0.0.0",
              "match_type": "mask",
              "mask": "224.0.0.0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$L3_IN_PORT",
                  "value": "<l3_in_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv6 Unicast)",
          "priority": "1",
          "doc": [
            "L3 Route.",
            "Automatic rule, added when L3 Route added. Deleted when L3 Route deleted.",
            "Read only to CONTROLLER.",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv6 Multicast)",
          "priority": "2",
          "doc": [
            "L3 Route.",
            "Automatic rule, added when L3 Route added. Deleted when L3 Route deleted.",
            "Read only to CONTROLLER.",
            "MPLS_TC argument supplied from packet  for QoS table lookup.",
            "L3_IN_PORT used for multicast L3 source removal."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "FF00:0:0:0:0:0:0:0",
              "match_type": "mask",
              "mask": "FF00:0:0:0:0:0:0:0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$L3_IN_PORT",
                  "value": "<l3_in_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward (IPv4) based on this label (PHP)",
          "priority": "1",
          "doc": [
            "L3 Forward (no routing lookup)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward (IPv6) based on this label (PHP)",
          "priority": "1",
          "doc": [
            "L3 Forward (no routing lookup)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section OAM",
          "priority": "3",
          "doc": [
            "Section OAM - Match GAL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "13",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "PW BHH Unexpected Control",
          "priority": "0",
          "doc": [
            "PW Unexpected OAM (ACH control frame) - Drop",
            "This is a built-in default rule (does not appear it can be controlled)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "0",
              "match_type": "all_or_exact"
            },
            {
              "field": "IN_PORT",
              "value": "0",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default drop"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS 2",
      "doc": [
        "Second MPLS match table. Matches outermost label after pop.",
        "Cannot be updated directly, must be via MPLS 1 update."
      ],
      "flow_mod_types": [
        {
          "name": "Pop Tunnel Label and forward based on next label",
          "priority": "1",
          "doc": [
            "LSP Pop. This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 3"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on this label (PHP)",
          "priority": "1",
          "doc": [
            "PHP Pop. PHP Actions are not OAM enabled.",
            "MPLS_TC argument supplied from packet for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label and forward based on this label",
          "priority": "1",
          "doc": [
            "LSP Swap. This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label and forward based on this label",
          "priority": "1",
          "doc": [
            "PW Swap, like LSP swap but BOS. Used for MS-PW.",
            "This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Swap Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label BHH and forward based on next label LSP OAM (MEP Data)",
          "priority": "1",
          "doc": [
            "LSP Pop - OAM (Data) - MEP, but a data frame - do OAM actions.",
            "Conflicts with non-OAM rule, only one or the other can be installed.",
            "Must be installed before control PDU rule.",
            "Check OAM Lock Status for LMEP_Id",
            "Count if LM if enabled for  LMEP_Id",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS 3"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<drop_status_id>",
                  //"type": 1
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<lmep_id>",
                  //"type": 0
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Pop Tunnel Label and forward based on next label (LSP OAM MEP Control)",
          "priority": "2",
          "doc": [
            "LSP Pop OAM (Control) - MEP OAM PDU.",
            "Pop GAL and make packet look like an Ethernet OAM frame.",
            "Higher priority than non-OAM rule for this label, which must be installed first."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap Tunnel Label BHH LSP OAM (MIP Control)",
          "priority": "2",
          "doc": [
            "LSP MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop GAL and make packet look like an Ethernet OAM frame"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_TTL",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "Swap PW Label BHH MS-PW OAM (MIP Control)",
          "priority": "2",
          "doc": [
            "PW MIP. No LM/DM at MIP, so no data action.",
            "Higher priority than non-OAM rule for this label, which must be installed first.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Can only have a MIP on a swap action."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch VPWS (PW Terminate)",
          "priority": "1",
          "doc": [
            "VPWS PW Terminate.",
            "This label is not OAM enabled.",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Policy ACL"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L2 Switch VPWS (PW Terminate) (MEP Data)",
          "priority": "1",
          "doc": [
            "VPLS PW Terminate - MEP Data.",
            "Conflicts with non-OAM enabled rule, only one or the other can be installed.",
            "Must be installed before adding control PDU rule for this MEP.",
            "Does not take effect until control PDU rule installed.",
            "Check OAM Lock Status for LMEP_Id.",
            "Count if LM if enabled for  LMEP_Id.",
            "MPLS_TC argument supplied from packet."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "0",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<drop_status_id>",
                  //"type": 1
                },
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<lmep_id>",
                  //"type": 0
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x6558"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "action": "$POP_L2_HEADER"
                },
                {
                  "action": "SET_FIELD",
                  "field": "TUNNEL_ID",
                  "value": "<tunnel_id>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$MPLS_L2_PORT",
                  "value": "<mpls_l2_port>"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "$COLOR_BASED_RX_COUNT"
                  //"index": "<mpls_label>"
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW BHH VCCV 4 (PW Terminate) (MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP control packet.",
            "BHH enabled, next label is GAL.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first, otherwise error.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$NEXT_LABEL_IS_GAL",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW BHH VCCV 1 (PW Terminate) (MEP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MEP control packet.",
            "BHH enabled, next label is GAL.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Data rule must be installed first, otherwise error.",
            "Only one  VCCV control rule per label."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PW BHH VCCV 3 (MIP Control)",
          "priority": "2",
          "doc": [
            "PW Terminate for MIP control packet.",
            "Pop PW label and make packet look like an Ethernet OAM frame.",
            "Higher priority than non-OAM label rule, which must be installed first.",
            "Only one  VCCV control rule per label.",
            "This type of control is only for a MIP."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$MPLS_ACH_CHANNEL",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8847"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$PROTECTION_INDEX",
                      "value": "<protection_index>"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv4 Unicast)",
          "priority": "1",
          "doc": [
            "L3 Route. Not OAM enabled.",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv4 Multicast)",
          "priority": "2",
          "doc": [
            "L3 Route.",
            "Automatic rule, added when L3 Route added. Deleted when L3 Route deleted.",
            "Read only to CONTROLLER.",
            "MPLS_TC argument supplied from packet  for QoS table lookup.",
            "L3_IN_PORT used for multicast L3 source removal."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "224.0.0.0",
              "match_type": "mask",
              "mask": "224.0.0.0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$L3_IN_PORT",
                  "value": "<l3_in_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv6 Unicast)",
          "priority": "1",
          "doc": [
            "L3 Route.",
            "Automatic rule, added when L3 Route added. Deleted when L3 Route deleted.",
            "Read only to CONTROLLER.",
            "MPLS_TC argument supplied from packet  for QoS table lookup."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Unicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Route (IPv6 Multicast)",
          "priority": "2",
          "doc": [
            "L3 Route.",
            "Automatic rule, added when L3 Route added. Deleted when L3 Route deleted.",
            "Read only to CONTROLLER.",
            "MPLS_TC argument supplied from packet  for QoS table lookup.",
            "L3_IN_PORT used for multicast L3 source removal."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "6",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "FF00:0:0:0:0:0:0:0",
              "match_type": "mask",
              "mask": "FF00:0:0:0:0:0:0:0"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Multicast Routing"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                },
                {
                  "action": "SET_FIELD",
                  "field": "$VRF",
                  "value": "<vrf>"
                },
                {
                  "action": "SET_FIELD",
                  "field": "$L3_IN_PORT",
                  "value": "<l3_in_port>"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward (IPv4) based on this label (PHP)",
          "priority": "1",
          "doc": [
            "L3 Forward (no routing lookup)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x0800 "
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "L3 VPN Forward (IPv6) based on this label (PHP)",
          "priority": "1",
          "doc": [
            "L3 Forward (no routing lookup)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "<mpls_label>",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "4",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "COPY_TTL_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$COPY_MPLS_TC_IN"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "$MPLS_SET_QOS_FROM_TABLE"
                      //"index": "<qos_index>"
                    }
                  ]
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x86dd "
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                },
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Fast Failover>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Section OAM",
          "priority": "3",
          "doc": [
            "Section OAM - Match GAL"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "13",
              "match_type": "exact"
            },
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "MPLS-TP Maintenance Point"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                },
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "POP_MPLS",
                  "ethertype": "0x8902"
                },
                {
                  "action": "$POP_CW_OR_ACH"
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$COLOR_BASED_RX_COUNT"
                      //"index": "<mpls_label>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "PW BHH Unexpected Control",
          "priority": "0",
          "doc": [
            "PW Unexpected OAM (ACH control frame) - Drop",
            "This is a built-in default rule (does not appear it can be controlled)"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8847",
              "match_type": "exact"
            },
            {
              "field": "MPLS_BOS",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "MPLS_LABEL",
              "value": "0",
              "match_type": "all_or_exact"
            },
            {
              "field": "IN_PORT",
              "value": "0",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_DATA_FIRST_NIBBLE",
              "value": "1",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "DEC_MPLS_TTL"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default drop"
          ],
          "match_set": [],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS-TP Maintenance Point",
      "doc": [
        "Process OAM frame for G.8113.1 Down MEP or MIP."
      ],
      "flow_mod_types": [
        {
          "name": "MEP PDU Process G.8113.1",
          "priority": "3",
          "doc": [
            "ETH-TYPE is to satisfy OpenFlow prerequisite."
          ],
          "match_set": [
            {
              "field": "LMEP ID",
              "value": "<lmep_id>",
              "match_type": "exact"
            },
            {
              "field": "OAM_Y1731_MDL",
              "value": "7",
              "match_type": "exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "$CHECK_DROP_STATUS"
                  //"drop_id": "<lmep_id>",
                  //"type": 0
                },
                {
                  "action": "$OAM_SET_COUNTER_FIELDS"
                  //"lmep_id": "<lmep_id>",
                  ////"traffic_class": "<pcp>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "LMEP PDU Drop",
          "priority": "0",
          "doc": [
            "Default rule, built in. ",
            "Should notify by count or output to Controller."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            }
          ]
        }
      ]
    },
    {
      "name": "Unicast Routing",
      "doc": [
        "Supports exact and LPM match on IP destination address"
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Unicast BFD",
          "priority": "4",
          "doc": [
            "Matches BFD packets, trap to BFD table. VRF default is zero.",
            "Must be higher relative priority than overlapping rules."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv4_dst>",
              "match_type": "exact"
            },
            {
              "field": "IP_PROTO",
              "value": "17",
              "match_type": "exact"
            },
            {
              "field": "UDP_DST",
              "value": "3784",
              "match_type": "mask",
              "mask": "0xfffe"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP Src>",
              "match_type": "mask",
              "mask": "0xc000"
            },
            {
              "field": "$VRF",
              "value": "<UDP Src>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "BFD"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 MPLS BFD",
          "priority": "4",
          "doc": [
            "Matches BFD packets to loopback address, trap to BFD table.",
            "Must be higher relative priority than overlapping rules."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "127.0.0.0",
              "match_type": "mask",
              "mask": "127.0.0.0"
            },
            {
              "field": "IP_PROTO",
              "value": "17",
              "match_type": "exact"
            },
            {
              "field": "UDP_DST",
              "value": "3784",
              "match_type": "exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP Src>",
              "match_type": "mask",
              "mask": "0xc000"
            },
            {
              "field": "$VRF",
              "value": "<UDP Src>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "BFD"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Unicast Host",
          "priority": "3",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv4_dst>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L3 VPN Label>"
                    }
                  ]
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Unicast LPM",
          "priority": "2",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv4_dst>",
              "match_type": "prefix"
            },
            {
              "field": "$VRF",
              "value": "",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L3 VPN Label>"
                    }
                  ]
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Unicast BFD",
          "priority": "4",
          "doc": [
            "Matches BFD packets, trap to BFD table.",
            "Must be higher relative priority than overlapping rules."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv6_d>",
              "match_type": "exact"
            },
            {
              "field": "IP_PROTO",
              "value": "17",
              "match_type": "exact"
            },
            {
              "field": "UDP_DST",
              "value": "3784",
              "match_type": "mask",
              "mask": "0xfffe"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP Src>",
              "match_type": "mask",
              "mask": "0xc000"
            },
            {
              "field": "$VRF",
              "value": "<UDP Src>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "BFD"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 MPLS BFD",
          "priority": "4",
          "doc": [
            "Matches BFD packets to IPv6 loopback, trap to BFD table.",
            "Must be higher relative priority than overlapping rules."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "0:0:0:0:0:FFFF:7F00",
              "match_type": "mask",
              "mask": "0:0:0:0:0:FFFF:7F00:0"
            },
            {
              "field": "IP_PROTO",
              "value": "17",
              "match_type": "exact"
            },
            {
              "field": "UDP_DST",
              "value": "3784",
              "match_type": "exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP Src>",
              "match_type": "mask",
              "mask": "0xc000"
            },
            {
              "field": "$VRF",
              "value": "<UDP Src>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "BFD"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Unicast Host",
          "priority": "3",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv6_d>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L3 VPN Label>"
                    }
                  ]
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Unicast LPM",
          "priority": "2",
          "doc": [
            "Matches normal packets as for OF-DPA 1.0"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IP_DST",
              "value": "<ipv6_d>",
              "match_type": "prefix"
            },
            {
              "field": "$VRF",
              "value": "",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L3 VPN Label>"
                    }
                  ]
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default pass through, Policy ACL must forward or packet dropped."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "Multicast Routing",
      "doc": [
        "Routes IPv4 and IPv6 multicast frames.",
        "VLAN Id or L2_IN_PORT used for source removal."
      ],
      "flow_mod_types": [
        {
          "name": "IPv4 Multicast",
          "priority": "1",
          "doc": [
            "Specific IPv4 Multicast Destination Address",
            "VID used for source removal"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "<ipv4_addr>",
              "match_type": "exact",
              "const_mask": "224.0.0.0",
              "const_value": "224.0.0.0"
            },
            {
              "field": "IPV4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Multicast>"
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast",
          "priority": "1",
          "doc": [
            "Specific IPv6 Multicast Destination Address",
            "VID used for source removal"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "exact",
              "const_mask": "ff00:0:0:0:0:0:0:0 ",
              "const_value": "ff00:0:0:0:0:0:0:0"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Multicast>"
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Multicast MPLS L3 VPN",
          "priority": "2",
          "doc": [
            "Specific IPv4 Multicast Destination Address",
            "Used for MPLS L3 VPN",
            "L3_IN_PORT used for source removal",
            "Must be paired with IPv6 rule"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x0800",
              "match_type": "exact"
            },
            {
              "field": "IPV4_DST",
              "value": "<ipv4_addr>",
              "match_type": "exact",
              "const_mask": "224.0.0.0",
              "const_value": "224.0.0.0"
            },
            {
              "field": "IPV4_SRC",
              "value": "<ipv4_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$L3 IN_PORT",
              "value": "<l3_in_port>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Multicast>"
                },
                {
                  "action": "DEC_NW_TTL"
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Multicast MPLS L3 VPN",
          "priority": "2",
          "doc": [
            "Specific IPv6 Multicast Destination Address",
            "Used for MPLS L3 VPN",
            "L3_IN_PORT used for source removal",
            "Must be paired with IPv4 rule"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "IPV6_DST",
              "value": "<ipv6_addr>",
              "match_type": "exact",
              "const_mask": "ff00:0:0:0:0:0:0:0 ",
              "const_value": "ff00:0:0:0:0:0:0:0"
            },
            {
              "field": "IPV6_SRC",
              "value": "<ipv6_addr>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$L3 IN_PORT",
              "value": "<l3_in_port>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default pass through, Policy ACL must forward or packet dropped."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "Bridging",
      "doc": [
        "L2 switching based on destination MAC and VLAN or Tunnel Id.",
        "Tunnel used for forwarding in isolated overlay domain."
      ],
      "flow_mod_types": [
        {
          "name": "Unicast VLAN",
          "priority": "3",
          "doc": [
            "Switch packet in VLAN."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "00-00-00-00-00-00"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "Multicast VLAN",
          "priority": "3",
          "doc": [
            "Replicate packet in VLAN."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "01-00-00-00-00-00"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "DLF VLAN",
          "priority": "2",
          "doc": [
            "Flood packet in VLAN."
          ],
          "match_set": [
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Flood"
                }
              ]
            }
          ]
        },
        {
          "name": "Unicast Overlay",
          "priority": "5",
          "doc": [
            "Switch packet in tenant forwarding domain."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "00-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00000000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "OUTPUT",
                  "port": "<lport_no>"
                }
              ]
            }
          ]
        },
        {
          "name": "Multicast Overlay",
          "priority": "5",
          "doc": [
            "Replicate packet in tenant forwarding domain."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "01-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00000000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "Overlay Multicast"
                }
              ]
            }
          ]
        },
        {
          "name": "DLF Overlay",
          "priority": "4",
          "doc": [
            "Flood packet in tenant forwarding domain."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00000000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "Overlay Flood"
                }
              ]
            }
          ]
        },
        {
          "name": "Unicast MPLS-TP VPLS network",
          "priority": "7",
          "doc": [
            "VPLS terminate and switch - network traffic.",
            "Traffic from NNI can be forwarded only to a UNI port.",
            "MPLS L2 Tag only used for SD_Tag action,",
            "otherwise one of the L2 Interface group types"
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "00-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00030000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Unicast MPLS-TP VPLS local",
          "priority": "7",
          "doc": [
            "VPLS initiate - local traffic.",
            "Traffic from UNI can be forwarded to UNI or NNI port."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "00-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "exactly_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Unfiltered Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 Tag>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS L2 VPN Label>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS Fast Failover>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<MPLS 1+1 Head End Protection>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Multicast MPLS-TP VPLS network",
          "priority": "7",
          "doc": [
            "VPLS Multicast replicate - network traffic.",
            "Split Horizon check for traffic from NNI.",
            "Should be paired with local rule."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "01-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00030000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Local Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "Multicast MPLS-TP VPLS local",
          "priority": "7",
          "doc": [
            "VPLS Multicast replicate - local traffic.",
            "Split Horizon check for traffic from UNI.",
            "Should be paired with network rule."
          ],
          "match_set": [
            {
              "field": "ETH_DST",
              "value": "<mac>",
              "match_type": "exact",
              "const_mask": "01-00-00-00-00-00",
              "const_value": "01-00-00-00-00-00"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Multicast>"
                }
              ]
            }
          ]
        },
        {
          "name": "DLF MPLS-TP VPLS network",
          "priority": "6",
          "doc": [
            "VPLS Multicast flood - network traffic.",
            "Split Horizon check for traffic from NNI.",
            "Should be paired with local rule."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00030000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Local Flood>"
                }
              ]
            }
          ]
        },
        {
          "name": "DLF MPLS-TP VPLS local",
          "priority": "6",
          "doc": [
            "VPLS Multicast flood - local traffic.",
            "Split Horizon check for traffic from UNI.",
            "Should be paired with network rule."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": " 0x00010000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Flood>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "VLAN and Overlay Default",
          "priority": "0",
          "doc": [
            "Built-in default. Policy ACL must forward or packet dropped."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "0x00000000",
              "match_type": "mask",
              "mask": "0xffff0000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS-TP Default - VPLS network",
          "priority": "0",
          "doc": [
            "Built-in default. Policy ACL must forward or packet dropped."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0xffff0000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00030000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MPLS-TP Default - VPLS local",
          "priority": "0",
          "doc": [
            "Built-in default. Policy ACL must forward or packet dropped."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "0x00010000",
              "match_type": "mask",
              "mask": "0xffff0000"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "exact",
              "const_mask": "0xffff0000",
              "const_value": "0x00010000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer"
            },
            {
              "zero_or_one": [
                {
                  "instruction": "APPLY_ACTIONS",
                  "actions": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Policer",
      "doc": [
        "Per-service meters applied to Ethernet Service frames from UNI."
      ],
      "flow_mod_types": [
        {
          "name": "MPLS_L2_Port  Meter",
          "priority": "2",
          "doc": [
            "Must be a UNI-NNI flow (MPLS_L2_Port is local).",
            "Meter index must be greater than 0xffff."
          ],
          "match_set": [
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "MPLS_L2_PORT",
              "value": "<mpls_l2_port>",
              "match_type": "mask",
              "mask": "0xffff0000",
              "const_value": "0x00000000",
              "const_mask": "0x00020000"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "<meter_index>"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "L2 Policer Actions"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$COLOR_ACTIONS_INDEX",
                  "value": "<index>"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Default rule, used if not supported or bypassed."
          ],
          "match_set": [],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Policy ACL"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Policer Actions",
      "doc": [
        "Actions based on packet color.",
        "Must be separate from L2 Policer table."
      ],
      "flow_mod_types": []
    },
    {
      "name": "Policy ACL",
      "doc": [
        "Match on variety of fields.",
        "Can redirect, drop, meter, copy-to-CONTROLLER, etc."
      ],
      "flow_mod_types": [
        {
          "name": "IPv6 VLAN",
          "priority": "4",
          "doc": [
            "IPv6 - switched/bridged packet including encapsulated MPLS"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<ETH-SRC>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<ETH-DST>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<VLAN_VID>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<VLAN_PCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<VLAN_DEI>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_SRC",
              "value": "<IPv6_SRC>",
              "match_type": "mask"
            },
            {
              "field": "IPv6_DST",
              "value": "<IPv6 DST>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<IP Proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<IP DSCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<IP ECN>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<TCP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "match_type",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "Optional (Meter Index)"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Color Based Actions"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR_ACTIONS_INDEX",
                      "value": "<color_actions_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Rewrite>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 Overlay",
          "priority": "3",
          "doc": [
            "IPv6 - tunneled Ethernet packet"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<ETH-SRC>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<ETH-DST>",
              "match_type": "mask"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_SRC",
              "value": "<IPv6_SRC>",
              "match_type": "mask"
            },
            {
              "field": "IPv6_DST",
              "value": "<IPv6 DST>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<IP Proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<IP DSCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<IP ECN>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<TCP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "match_type",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "Optional (Meter Index)"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Color Based Actions"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR_ACTIONS_INDEX",
                      "value": "<color_actions_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "<lport_no>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Overlay Multicast>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv6 MPLS-TP",
          "priority": "4",
          "doc": [
            "IPv6 - inner Ethernet packet (initiation or termination)"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "0x86dd",
              "match_type": "exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<ETH-SRC>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<ETH-DST>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<VLAN_VID>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<VLAN_PCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<VLAN_DEI>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv6_SRC",
              "value": "<IPv6_SRC>",
              "match_type": "mask"
            },
            {
              "field": "IPv6_DST",
              "value": "<IPv6 DST>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<IP Proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<IP DSCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<IP ECN>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<TCP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_TYPE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV6_CODE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "match_type",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "exact",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "Optional (Meter Index)"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Color Based Actions"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR_ACTIONS_INDEX",
                      "value": "<color_actions_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Rewrite>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 VLAN",
          "priority": "2",
          "doc": [
            "IPv4 - switched/bridged packet including encapsulated MPLS"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<ETH-TYPE>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<ETH-SRC>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<ETH-DST>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<VLAN_VID>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<VLAN_PCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<VLAN_DEI>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<IPv4 SRC>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<IPv4 DST>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<IP Proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<IP DSCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<IP ECN>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<TCP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ARP_SPA",
              "value": "mask",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "Optional (Meter Index)"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Color Based Actions"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR_ACTIONS_INDEX",
                      "value": "<color_actions_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Rewrite>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 Overlay",
          "priority": "1",
          "doc": [
            "IPv4 - tunneled Ethernet packet"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<lport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<ETH-TYPE>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<ETH-SRC>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<ETH-DST>",
              "match_type": "mask"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<IPv4 SRC>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<IPv4 DST>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<IP Proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<IP DSCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<IP ECN>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<TCP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ARP_SPA",
              "value": "mask",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "Optional (Meter Index)"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Color Based Actions"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR_ACTIONS_INDEX",
                      "value": "<color_actions_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "<lport_no>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Overlay Multicast>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "IPv4 MPLS-TP",
          "priority": "2",
          "doc": [
            "IPv4 - inner Ethernet packet (initiation or termination)"
          ],
          "match_set": [
            {
              "field": "IN_PORT",
              "value": "<pport_no>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_TYPE",
              "value": "<ETH-TYPE>",
              "match_type": "all_or_exact"
            },
            {
              "field": "ETH_SRC",
              "value": "<ETH-SRC>",
              "match_type": "mask"
            },
            {
              "field": "ETH_DST",
              "value": "<ETH-DST>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_VID",
              "value": "<VLAN_VID>",
              "match_type": "mask"
            },
            {
              "field": "VLAN_PCP",
              "value": "<VLAN_PCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "$VLAN_DEI",
              "value": "<VLAN_DEI>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_ID",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "$VRF",
              "value": "<vrf>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IPv4_SRC",
              "value": "<IPv4 SRC>",
              "match_type": "mask"
            },
            {
              "field": "IPv4_DST",
              "value": "<IPv4 DST>",
              "match_type": "mask"
            },
            {
              "field": "IP_PROTO",
              "value": "<IP Proto>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_DSCP",
              "value": "<IP DSCP>",
              "match_type": "all_or_exact"
            },
            {
              "field": "IP_ECN",
              "value": "<IP ECN>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_SRC",
              "value": "<TCP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_SRC",
              "value": "<UDP SRC>",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_SRC",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_TYPE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "ICMPV4_CODE",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "TCP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "UDP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "SCTP_DST",
              "value": "all_or_exact",
              "match_type": "all_or_exact"
            },
            {
              "field": "$MPLS_L2_PORT",
              "value": "exact",
              "match_type": "exact"
            },
            {
              "field": "ARP_SPA",
              "value": "mask",
              "match_type": "mask"
            }
          ],
          "instruction_set": [
            {
              "instruction": "METER",
              "meter_name": "Optional (Meter Index)"
            },
            {
              "instruction": "GOTO_TABLE",
              "table": "Color Based Actions"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR_ACTIONS_INDEX",
                      "value": "<color_actions_index>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$COLOR",
                      "value": "<color>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic-class>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Interface>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Rewrite>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L2 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Unicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 Multicast>"
                    },
                    {
                      "action": "GROUP",
                      "group_id": "<L3 ECMP>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Pass through default",
          "priority": "0",
          "doc": [
            "Default rule, built in. Process action set, do not drop packet."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    },
    {
      "name": "Color Based Actions",
      "doc": [
        "Apply color based actions after metering in Policy ACL.",
        "Must be a separate table."
      ],
      "flow_mod_types": [
        {
          "name": "Red Actions",
          "priority": "2",
          "doc": [
            "Clear-actions with no next table is used for drop.",
            "Change Traffic Class (changes OUTPUT priority queue)."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "0",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_no>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Yellow Actions",
          "priority": "2",
          "doc": [
            "Clear-actions with no next table is used for drop.",
            "Change Traffic Class (changes OUTPUT priority queue)."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "1",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_no>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Green Actions",
          "priority": "2",
          "doc": [
            "Clear-actions with no next table is used for drop.",
            "Change Traffic Class (changes OUTPUT priority queue)."
          ],
          "match_set": [
            {
              "field": "$COLOR",
              "value": "2",
              "match_type": "exact"
            },
            {
              "field": "$COLOR_ACTIONS_INDEX",
              "value": "<color_actions_index>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "IP_DSCP",
                      "value": "<dscp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "IP_ECN",
                      "value": "<ecn>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "SET_FIELD",
                      "field": "$TRAFFIC_CLASS",
                      "value": "<traffic_class>"
                    },
                    {
                      "action": "SET_QUEUE",
                      "queue_id": "<queue_no>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default Pass",
          "priority": "0",
          "match_set": [],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Egress VLAN",
      "doc": [
        "Used for Egress VLAN Translation.",
        "If Ethernet Service OAM MIP or Up MEP then send frame to Egress Maintenance Point."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Translate Single Tag or Single to Double",
          "priority": "2",
          "doc": [
            "Final packet can be untagged, single tagged, or double tagged.",
            "If MIP and/or MEP go to Egress Maintenance Point,",
            "otherwise OUTPUT packet."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "zero_or_one": [
                {
                  "instruction": "GOTO_TABLE",
                  "table": "Egress Maintenance Point"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "instruction": "CLEAR_ACTIONS"
                }
              ]
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "POP_VLAN"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    },
                    {
                      "all": [
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        },
                        {
                          "action": "PUSH_VLAN",
                          "value": "<tpid>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_RX_COUNT"
                      //"index": "<tunnel_id>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "VLAN Translate Double Tag",
          "priority": "2",
          "doc": [
            "Process as double tagged packet."
          ],
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID ",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress VLAN 1"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$OVID",
                  "value": "<vid>"
                },
                {
                  "action": "POP_VLAN"
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Output packet on miss."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    },
    {
      "name": "Egress VLAN 1",
      "doc": [
        "Used to process inner tag on double tagged packets.",
        "Final packet can be untagged, single tagged, or double tagged."
      ],
      "flow_mod_types": [
        {
          "name": "VLAN Assignment",
          "priority": "1",
          "match_set": [
            {
              "field": "$ACTSET_OUTPUT ",
              "value": "<pport_no>",
              "match_type": "exact"
            },
            {
              "field": "VLAN_VID",
              "value": "<vid>",
              "match_type": "exact"
            },
            {
              "field": "$OVID",
              "value": "<vid>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "GOTO_TABLE",
              "table": "Egress Maintenance Point"
            },
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "POP_VLAN"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_ID",
                      "value": "<vid>"
                    },
                    {
                      "all": [
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        },
                        {
                          "action": "PUSH_VLAN",
                          "value": "<tpid>"
                        },
                        {
                          "action": "SET_FIELD",
                          "field": "VLAN_ID",
                          "value": "<vid>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "instruction": "WRITE_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CLASS_BASED_RX_COUNT"
                      //"index": "<tunnel_id>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "Output packet on miss."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    },
    {
      "name": "Egress Maintenance Point",
      "doc": [
        "Process OAM frame for MIP or Up MEP.",
        "Data frames may be counted and forwarded."
      ],
      "flow_mod_types": [
        {
          "name": "MIP PDU Process (LBM)",
          "priority": "5",
          "doc": [
            "Ethernet Service MIP (LBM).",
            "LMEP_Id is of MIP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "3",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_I(D",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST",
              "value": "<local_mac>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$OAM_SET_COUNTER_FIELDS"
                  //"lmep_id": "<lmep_id>",
                  ////"traffic_class": "<traffic_class>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "MIP PDU Process (our LTM)",
          "priority": "5",
          "doc": [
            "Ethernet Service MIP (LTM).",
            "LMEP_Id is of MIP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "5",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_I(D",
              "value": "<tunnel_id>",
              "match_type": "exact"
            },
            {
              "field": "ETH_DST",
              "value": "01-80-c2-00-00-38",
              "match_type": "mask",
              "mask": "ff-ff-ff-ff-ff-ff-f8"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$OAM_SET_COUNTER_FIELDS"
                  //"lmep_id": "<lmep_id>",
                  //"traffic_class": "<traffic_class>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Process (Provider Up or Down MEP)",
          "priority": "4",
          "doc": [
            "Process all PDUs at Provider MDL.",
            "LMEP_Id is of Provider MEP"
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_I(D",
              "value": "<tunnel_id>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "action": "SET_FIELD",
                  "field": "$LMEP_ID",
                  "value": "<lmep_id>"
                },
                {
                  "action": "$OAM_SET_COUNTER_FIELDS"
                  //"lmep_id": "<lmep_id>",
                  //"traffic_class": "<traffic_class>"
                },
                {
                  "one_or_more": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Passthrough (higher Client MDL)",
          "priority": "3",
          "doc": [
            "For Ethernet OAM packets must  be programmed to pass through higher MDL.",
            "Packet forwarded to original OUTPUT port.",
            "LMEP_Id is of Provider MEP in LCK and LM counter."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_MDL",
              "value": "<mdl>",
              "match_type": "exact"
            },
            {
              "field": "TUNNEL_I(D",
              "value": "<tunnel_id>",
              "match_type": "all_or_exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id_1>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id_1>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id_2>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id_2>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "PDU Drop (lower MDL)",
          "priority": "2",
          "doc": [
            "Must be programmed for active filtering. Applies to both MIP and MEP.",
            "Output is for notification.",
            "Can selectively notify by message, usually just for CCM."
          ],
          "match_set": [
            {
              "field": "ETH_TYPE",
              "value": "0x8902",
              "match_type": "exact"
            },
            {
              "field": "$OAM_Y1731_OPCODE",
              "value": "<opcode>",
              "match_type": "all_or_exact"
            },
            {
              "field": "TUNNEL_I(D",
              "value": "<tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "CLEAR_ACTIONS"
            },
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "OUTPUT",
                      "port": "LOCAL"
                    },
                    {
                      "action": "OUTPUT",
                      "port": "CONTROLLER"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "Data Passthough (Up or Down MEP)",
          "priority": "1",
          "doc": [
            "Override default rule for Provider MEP.",
            "LMEP_Id is for Provider MEP."
          ],
          "match_set": [
            {
              "field": "TUNNEL_I(D",
              "value": "<tunnel_id>",
              "match_type": "exact"
            }
          ],
          "instruction_set": [
            {
              "instruction": "APPLY_ACTIONS",
              "actions": [
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id_1>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id_1>"
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$CHECK_DROP_STATUS"
                      //"lmep_id": "<lmep_id_2>",
                      //"type": 0
                    }
                  ]
                },
                {
                  "zero_or_one": [
                    {
                      "action": "$OAM_LM_RX_COUNT"
                      //"lmep_id": "<lmep_id_2>"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ],
      "built_in_flow_mods": [
        {
          "name": "Default",
          "priority": "0",
          "doc": [
            "There's suppposed to be a MEP or MIP here.",
            "But don't know what to do with this packet, so just forward it."
          ],
          "match_set": [],
          "instruction_set": []
        }
      ]
    }
  ],
  "group_entry_types": [
    {
      "name": "L2 Rewrite",
      "doc": [
        "Used to modify Ethernet header fields for bridged packets.",
        "Naming Convention : Type [31:28]:1, Id [27:0]:0xnnnnnn, :"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MAC_SRC"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MAC_DST"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_ID"
                }
              ]
            },
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Multicast",
      "doc": [
        "Used to specify L2 Multicast replication.",
        "VLAN id values must be consistent.",
        "Naming Convention : Type [31:28]:3, VLAN Id [27:16]:0xnnn, Id [15:0]:0xnnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Flood",
      "doc": [
        "Used to specify flooding in a VLAN.",
        "VLAN id values must be consistent.",
        "Recommended instead of FLOOD reserved port.",
        "Naming Convention : Type [31:28]:4, VLAN Id [27:16]:0xnnn, Id [15:0]:0xnnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Fast Failover",
      "doc": [
        "Working (1) or backup (0) path bucket.",
        "Both buckets either Routing or MPLS LSR.",
        "Watch OAM Protection Liveness Logical Port",
        "Naming Convention: Type [31:28]:13, Index [27:0]:0xnnnnnn"
      ],
      "group_type": "FAST_FAILOVER",
      "bucket_types": [
        {
          "name": "Working (1)",
          "action_set": [
            {
              "action": "GROUP",
              "group_id": "<L3 Unicast>"
            }
          ]
          //"watch": "<lport_no>"
        },
        {
          "name": "Protection (0)",
          "action_set": [
            {
              "action": "GROUP",
              "group_id": "<L3 Unicast>"
            }
          ]
          //"watch": "<lport_no>"
        }
      ]
    },
    {
      "name": "L3 ECMP",
      "doc": [
        "Used to specify IP multipath.",
        "Naming Convention : Type [31:28]:7, Id [27:0]:0xnnnnnn, :"
      ],
      "group_type": "SELECT",
      "bucket_types": [
        {
          "name": "Multipath Destination",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L3 Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Unicast",
      "doc": [
        "Used for Ethernet next hop configuration.",
        "ALLOW_IN_PORT=1 by default for this group.",
        "Naming Convention : Type [31:28]:2, Id [27:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC"
            },
            {
              "action": "SET_FIELD",
              "field": "MAC_DST"
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_ID"
            },
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Multicast",
      "doc": [
        "Used fo specify IP Replication.",
        "VLAN id values must be consistent",
        "Naming Convention : Type [31:28]:6, VLAN Id [27:16]:0xnnn, Id [15:0]:0xnnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L3 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L3 Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L3 Interface",
      "doc": [
        "Used for L3 multicast.",
        "ALLOW_IN_PORT=1 by default.",
        "VLAN Id must be consistent with interface group.",
        "Naming Convention : Type [31:28]:5, Id [27:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC"
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_ID"
            },
            {
              "action": "GROUP",
              "group_id": "<L2 Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Flood over Unicast Tunnels",
      "doc": [
        "L2 Overlay Flood over Unicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:0, Index [9:0]:0xnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Flood over Multicast Tunnels",
      "doc": [
        "L2 Overlay Flood over Multicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:1, Index [9:0]:0xnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Multicast over Unicast Tunnels",
      "doc": [
        "L2 Overlay Multicast over Unicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:2, Index [9:0]:0xnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Overlay Multicast over Multicast Tunnels",
      "doc": [
        "L2 Overlay Multicast over Multicast Tunnels.",
        "Output must be a logical port in tenant forwarding domain.",
        "Naming Convention : Type [31:28]:8, Tunnel Id [27:12]:0xnnnn, Sub-Type [11:10]:3, Index [9:0]:0xnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<lport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Flood",
      "doc": [
        "Packet is from UNI port",
        "Flood in customer forwarding domain to local UNI or NNI ports.",
        "Should only be one of these per customer with all customer domain ports.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:0, Index [23:0]:0xnnnnnn "
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS 1+1 Head End Protection>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Tag>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Multicast",
      "doc": [
        "Packet is from UNI port",
        "Forward in customer domain to local UNI or NNI ports.",
        "Should contain a subset of customer domain ports.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:1, Index [23:0]:0xnnnnnn "
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS 1+1 Head End Protection>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Tag>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Local Flood",
      "doc": [
        "Packet is from NNI port.",
        "Split Horizon -  flood in customer forwarding domain only to local UNI ports.",
        "Should be only one per customer with all UNI customer domain ports.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:2, Index [23:0]:0xnnnnnn "
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Tag>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Local Multicast",
      "doc": [
        "Packet is from NNI port.",
        "Split Horizon - only forward to local UNI ports.",
        "Should contain a subset of UNI customer domain ports.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:3, Index [23:0]:0xnnnnnn "
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replica",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 Tag>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Fast Failover",
      "doc": [
        "Working (1) or backup (0) path bucket. ",
        "Next Label depends on specifics of packet flow. ",
        "Both buckets must chain to the same group entry type.",
        "Naming Convention: Type [31:28]:10, Sub-Type [27:24]:6, Index{23:0]:0xnnnnnn"
      ],
      "group_type": "FAST_FAILOVER",
      "bucket_types": [
        {
          "name": "Working(1)",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
          //"watch": "<lport_no>"
        },
        {
          "name": "Protection(0) ",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
          //"watch": "<lport_no>"
        }
      ]
    },
    {
      "name": "MPLS 1+1 Head End Protection",
      "doc": [
        "Next Label depends on specifics of packet flow.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:7, Index{23:0]:0xnnnnnn"
      ],
      "group_type": "all_or_exact",
      "bucket_types": [
        {
          "name": "Replication",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 VPN Label",
      "doc": [
        "VLAN id and L2 Addresses are set in MPLS Interface group",
        "LM counters used for  PW OAM, Traffic Class supplied by switch",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:1, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "$PUSH_L2_HEADER"
            },
            {
              "action": "PUSH_VLAN"
            },
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "$PUSH_CW"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_BOS",
              "value": "1"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_VPN_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_TX_COUNT"
                  //"index": "<mpls_label>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT"
                  //"lmep_id": "$LMEP_ID"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS 1+1 Head End Protection>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L3 VPN Label",
      "doc": [
        "Used for L3 VPN tunnel initiation.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:2, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_BOS",
              "value": "1"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_VPN_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "$COPY_TTL_OUT"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_TX_COUNT"
                  //"index": "<mpls_label>"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Swap Label Group",
      "doc": [
        "LM count used for MPLS-TP LSP or PW",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:5, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_VPN_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_VPN_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_TX_COUNT"
                  //"index": "<mpls_label>"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS 1+1 Head End Protection>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Tunnel Label 1",
      "doc": [
        "Used for MPLS LSP.",
        "LM count used for G.8113.1 LSP only.",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:3, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_TUNNEL_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "COPY_TTL_OUT"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_TX_COUNT"
                  //"index": "<mpls_label>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT"
                  //"lmep_id": "$LMEP_ID"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS 1+1 Head End Protection>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 2>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Tunnel label 2",
      "doc": [
        "Used to push a third label for certain flows (e.g., ring label).",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:4, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "WriteShimHeaders",
          "action_set": [
            {
              "action": "PUSH_MPLS",
              "ethertype": "0x8847"
            },
            {
              "action": "SET_FIELD",
              "field": "MPLS_LABEL",
              "value": "<mpls_label>"
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TC",
                  "value": "<exp>"
                },
                {
                  "action": "$SET_MPLS_TC_FROM_TUNNEL_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP",
                      "value": "<pcp>"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI",
                      "value": "<dei>"
                    }
                  ]
                },
                {
                  "action": "$SET_MPLS_PCPDEI_FROM_TUNNEL_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "MPLS_TTL",
                  "ttl": "<ttl>"
                },
                {
                  "action": "COPY_TTL_OUT"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$COLOR_BASED_TX_COUNT"
                  //"index": "<mpls_label>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT"
                  //"lmep_id": "<lmep_id>"
                }
              ]
            },
            {
              "action": "GROUP",
              "group_id": "<MPLS Interface>"
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS ECMP",
      "doc": [
        "Used for MPLS multipath in PE, LER, or LSR.",
        "Naming Convention : Type [31:28]:10, Sub-type:8, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "SELECT",
      "bucket_types": [
        {
          "name": "Multipath Destination",
          "action_set": [
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L2 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Swap Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS L3 VPN Label>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Fast Failover>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Tunnel Label 1>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<MPLS Interface>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS Interface",
      "doc": [
        "Used to OUTPUT an MPLS encapsulated packet",
        "LM Count used for Section OAM, Traffic Class supplied by switch",
        "Naming Convention : Type [31:28]:9, Sub-Type [27:24]:0"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "RewriteEthernetHeader",
          "action_set": [
            {
              "action": "SET_FIELD",
              "field": "MAC_SRC"
            },
            {
              "action": "SET_FIELD",
              "field": "MAC_DST"
            },
            {
              "action": "SET_FIELD",
              "field": "VLAN_ID"
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "<L2 Unfiltered Interface>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "$OAM_LM_TX_COUNT"
                  //"lmep_id": "<lmep_id>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "MPLS L2 Tag",
      "doc": [
        "TPIDs are the ones allowed in the OpenFlow Spec.",
        "May have other constraints on TPID, TBD.",
        "Should have an action to change TPID.",
        "Naming Convention : Type [31:28]:10, Sub-Type [27:24]:10, Index [23:0]:0xnnnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "SD-TagActions",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "all": [
                    {
                      "action": "POP_VLAN"
                    },
                    {
                      "action": "PUSH_VLAN",
                      "value": "<tpid>"
                    }
                  ]
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "VLAN_ID",
                  "value": "<vid>"
                }
              ]
            },
            {
              "exactly_one": [
                {
                  "action": "GROUP",
                  "group_id": "<L2 Interface>"
                },
                {
                  "action": "GROUP",
                  "group_id": "L2 Unfiltered Interface>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Interface",
      "doc": [
        "Port VLAN filtering enabled, this VLAN allowed.",
        "Implementations can  use to configure egress port VLAN.",
        "Naming Convention : Type [31:28]:0, Vlan Id [27:16]:0xnnn, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "VlanTagging",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "POP_VLAN"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "DSCP"
                },
                {
                  "action": "$SET_DSCP_FROM_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI"
                    }
                  ]
                },
                {
                  "action": "$SET_PCPDEI_FROM_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Unfiltered Interface",
      "doc": [
        "Port has VLAN filtering disabled.",
        "Implementations can use to configure no egress port VLAN filtering.",
        "Naming Convention : Type [31:28]:11, Vlan Id [27:16]:0x000, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "AllowAllVLANs",
          "action_set": [
            {
              "zero_or_one": [
                {
                  "action": "POP_VLAN"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "action": "SET_FIELD",
                  "field": "DSCP"
                },
                {
                  "action": "$SET_DSCP_FROM_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "zero_or_one": [
                {
                  "one_or_more": [
                    {
                      "action": "SET_FIELD",
                      "field": "VLAN_PCP"
                    },
                    {
                      "action": "SET_FIELD",
                      "field": "$VLAN_DEI"
                    }
                  ]
                },
                {
                  "action": "$SET_PCPDEI_FROM_TABLE"
                  //"index": "<qos_index>"
                }
              ]
            },
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            }
          ]
        }
      ]
    },
    {
      "name": "L2 Loopback",
      "doc": [
        "Used for Ethernet Link OAM.",
        "Port in name must be a physical port.",
        "Naming Convention : Type [31:28]:12, Reserved [27:16]:0, Port [15:0]:0xnnnn"
      ],
      "group_type": "INDIRECT",
      "bucket_types": [
        {
          "name": "Loopback(EFM)",
          "action_set": [
            {
              "action": "OUTPUT",
              "port": "<pport_no>"
            }
          ]
        }
      ]
    }
  ],
  "meter_table": {
    "meter_types": [
      {
        "name": "OF-DPA Color-Set Meters",
        "bands": [
          // {
          //   "type": "Color Set",
          //   "color": {
          //     "exactly_one": [
          //       "green(0)",
          //       "yellow(1)",
          //       "red(2)"
          //     ]
          //   },
          //   "rate": "<meter_rate>",
          //   "burst": "<meter_burst>",
          //   "color_aware": {
          //     "exactly_one": [
          //       "Color Blind(0)",
          //       "Color Aware(1)"
          //     ]
          //   },
          //   "mode": {
          //     "exactly_one": [
          //       "TrTCM(1)",
          //       "SrTCM(2)",
          //       "Modified TrTCM(4)"
          //     ]
          //   }
          // }
        ]
      }
    ]
  }
}
